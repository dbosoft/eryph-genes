name: orchestration-test
parent: dbosoft/winsrv2022-standard/starter

variables:
  - name: environment
    value: production
    type: string
  - name: test_message
    value: "Orchestration test successful!"
    type: string

fodder:
  - source: gene:dbosoft/guest-services:win-install
  
  - name: orchestration-test-script
    type: shellscript
    filename: orchestration-test.ps1
    content: |
      #ps1_sysnative
      
      # Create test directory
      $testDir = "C:\OrchestrationTest"
      New-Item -Path $testDir -ItemType Directory -Force | Out-Null
      
      # Write environment file
      @"
      Environment: {{ environment }}
      Message: {{ test_message }}
      Timestamp: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")
      "@  | Out-File -FilePath "$testDir\test-results.txt" -Encoding UTF8
      
      # Create verification file
      @"
      Orchestration Pattern Test
      ========================
      This file confirms successful deployment through the multi-agent system.
      - Catlet created by eryph-specialist
      - Deployed by eryph-powershell-executor
      - Variables were substituted correctly
      - PowerShell script executed successfully
      "@  | Out-File -FilePath "$testDir\verification.txt" -Encoding UTF8
      
      Write-Host "Orchestration test files created successfully"